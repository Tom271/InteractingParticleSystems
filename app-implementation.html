<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>D Implementation of the Particle System | A Numerical Study of an Interacting Particle System</title>
  <meta name="description" content="D Implementation of the Particle System | A Numerical Study of an Interacting Particle System" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="D Implementation of the Particle System | A Numerical Study of an Interacting Particle System" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="D Implementation of the Particle System | A Numerical Study of an Interacting Particle System" />
  
  
  

<meta name="author" content="Tom271" />


<meta name="date" content="2020-05-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="app-ergavg.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />












</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="litreview.html"><a href="litreview.html"><i class="fa fa-check"></i><b>2</b> The Model</a></li>
<li class="chapter" data-level="3" data-path="num-studies.html"><a href="num-studies.html"><i class="fa fa-check"></i><b>3</b> Numerical Studies</a></li>
<li class="chapter" data-level="4" data-path="future.html"><a href="future.html"><i class="fa fa-check"></i><b>4</b> Future Work</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="app-prodmeasure.html"><a href="app-prodmeasure.html"><i class="fa fa-check"></i><b>A</b> Product Measure is a Solution to Kinetic PDE</a><ul>
<li class="chapter" data-level="A.1" data-path="app-prodmeasure.html"><a href="app-prodmeasure.html#product-distribution-is-a-solution"><i class="fa fa-check"></i><b>A.1</b> Product Distribution is a Solution</a></li>
<li class="chapter" data-level="A.2" data-path="app-prodmeasure.html"><a href="app-prodmeasure.html#convergence-depends-on-initial-average-velocity"><i class="fa fa-check"></i><b>A.2</b> Convergence Depends on Initial Average Velocity</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="app-PSmeanZero.html"><a href="app-PSmeanZero.html"><i class="fa fa-check"></i><b>B</b> Particle System has an Invariant Measure with Mean Zero</a></li>
<li class="chapter" data-level="C" data-path="app-ergavg.html"><a href="app-ergavg.html"><i class="fa fa-check"></i><b>C</b> Forms of Convergence</a><ul>
<li class="chapter" data-level="" data-path="app-ergavg.html"><a href="app-ergavg.html#convergence-in-law"><i class="fa fa-check"></i>Convergence in Law</a></li>
<li class="chapter" data-level="" data-path="app-ergavg.html"><a href="app-ergavg.html#convergence-of-ergodic-averages"><i class="fa fa-check"></i>Convergence of Ergodic Averages</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="app-implementation.html"><a href="app-implementation.html"><i class="fa fa-check"></i><b>D</b> Implementation of the Particle System</a><ul>
<li class="chapter" data-level="" data-path="app-implementation.html"><a href="app-implementation.html#v0.1"><i class="fa fa-check"></i>v0.1</a></li>
<li class="chapter" data-level="" data-path="app-implementation.html"><a href="app-implementation.html#v0.2"><i class="fa fa-check"></i>v0.2</a></li>
<li class="chapter" data-level="" data-path="app-implementation.html"><a href="app-implementation.html#v0.3"><i class="fa fa-check"></i>v0.3</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Numerical Study of an Interacting Particle System</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="app-implementation" class="section level1">
<h1><span class="header-section-number">D</span> Implementation of the Particle System</h1>
<p>The majority of my work this year has been spent implementing these particle systems in Python. They are available online:</p>
<p><a href="https://github.com/Tom271/InteractingParticleSystems/releases" class="uri">https://github.com/Tom271/InteractingParticleSystems/releases</a></p>
<p>There are currently three versions, and in this section each will be briefly described. Throughout the three versions the algorithm for solving the system consists of the Euler-Maruyama method. When simulating particle systems, a good rule of thumb is to choose the step size of the scheme such that 10 interactions can be resolved per particle collision. For example, if a particle is moving with velocity 1 and <span class="math inline">\(\gamma=0.1\)</span>, one should choose <span class="math inline">\(\Delta t \approx 0.01\)</span>. The difficulty arises in the high dimensionality of the system and simulating for long times.</p>
<div id="v0.1" class="section level2 unnumbered">
<h2>v0.1</h2>
<p>The first version developed was a basic implementation with limited functionality. It was able to simulate the full system, but it was difficult to run multiple experiments automatically. This prompted the development of an automated process to allow for easier computation. A custom plotting package was also developed to produce animations of the system on the torus.</p>
</div>
<div id="v0.2" class="section level2 unnumbered">
<h2>v0.2</h2>
<p>Version 0.2 moved towards an object-oriented approach for increased readability. It also introduced <em>processing.py</em>, a file for automated experiments. This meant we could pass a range of parameters to be tested. Then the list would be stored, and all subsets of the parameters would be evolved in the particle system. The position and velocity data is then stored with a random filename, while the parameters and file name is stored in separate YAML file. Then, when running any analysis, the YAML file is searched for matching parameters. The file name is then retrieved which then automatically loads in the trajectory data ready for analysis. This allowed for the automatic execution of 100 systems at once, such as those used to produce the heatmaps such as  and the average velocity plots such as . However, this code was rather slow and often took a few days to run.</p>
</div>
<div id="v0.3" class="section level2 unnumbered">
<h2>v0.3</h2>
<p>In version 0.3 (the current iteration), we moved away from an object-oriented style. This was so that we could exploit Numba, a just-in-time (JIT) compiler to massively increase computation speed <span class="citation">(Lam, Pitrou, and Seibert <a href="#ref-Numba" role="doc-biblioref">2015</a>)</span>. Implementing a JIT compiler allows for tests that previously took days to run in less than an hour. When interested in long time dynamics, this proves very useful!</p>

<div id="refs" class="references">
<div>
<p>Ballerini, Michele, Nicola Cabibbo, Raphael Candelier, Andrea Cavagna, Evaristo Cisbani, Irene Giardina, Alberto Orlandi, et al. 2008. “Empirical Investigation of Starling Flocks: A Benchmark Study in Collective Animal Behaviour.” <em>Animal Behaviour</em> 76 (July): 201–15. <a href="https://doi.org/10.1016/j.anbehav.2008.02.004">https://doi.org/10.1016/j.anbehav.2008.02.004</a>.</p>
</div>
<div>
<p>Bellet, Luc Rey. 2006. “Ergodic Properties of Markov Processes.” In <em>Open Quantum Systems Ii: The Markovian Approach</em>, edited by Stéphane Attal, Alain Joye, and Claude-Alain Pillet, 1–39. Berlin, Heidelberg: Springer Berlin Heidelberg. <a href="https://doi.org/10.1007/3-540-33966-3_1">https://doi.org/10.1007/3-540-33966-3_1</a>.</p>
</div>
<div>
<p>Bernardi, Sara, Gissell Estrada-Rodriguez, Heiko Gimperlein, and Kevin J. Painter. 2019. “Macroscopic Descriptions of Follower-Leader Systems.” <a href="http://arxiv.org/abs/1908.00284">http://arxiv.org/abs/1908.00284</a>.</p>
</div>
<div>
<p>Blondel, V. D., J. M. Hendrickx, and J. N. Tsitsiklis. 2007. “On the 2R Conjecture for Multi-Agent Systems.” In <em>2007 European Control Conference (Ecc)</em>, 874–81.</p>
</div>
<div>
<p>Bonner, John Tyler. 2009. <em>The Social Amoebae: The Biology of Cellular Slime Molds</em>. Princeton University Press. <a href="http://www.jstor.org/stable/j.ctt7s6qz">http://www.jstor.org/stable/j.ctt7s6qz</a>.</p>
</div>
<div>
<p>Buttà, Paolo, Franco Flandoli, Michela Ottobre, and Boguslaw Zegarlinski. 2019. “A Non-Linear Kinetic Model of Self-Propelled Particles with Multiple Equilibria.” <em>Kinetic &amp; Related Models</em> 12(4): 791–827.</p>
</div>
<div>
<p>Couzin, I. D., J. Krause, R. James, G. D. Ruxton, and N. R. Franks. 2002. “Collective Memory and Spatial Sorting in Animal Groups.” <em>Journal of Theoretical Biology</em> 218 (1): 1–11. <a href="https://doi.org/https://doi.org/10.1006/jtbi.2002.3065">https://doi.org/https://doi.org/10.1006/jtbi.2002.3065</a>.</p>
</div>
<div>
<p>Cucker, Felipe, and Stephen Smale. 2007. “Emergent Behavior in Flocks.” <em>IEEE Transactions on Automatic Control</em> 52: 852–62.</p>
</div>
<div>
<p>Czirok, Andras, Albert-Laszlo Barabasi, and Tamas Vicsek. 1997. “Collective Motion of Self-Propelled Particles: Kinetic Phase Transition in One Dimension.” <a href="http://arxiv.org/abs/cond-mat/9712154">http://arxiv.org/abs/cond-mat/9712154</a>.</p>
</div>
<div>
<p>Garnier, Josselin, G Papanicolaou, and Tzu-Wei Yang. 2019. “Mean Field Model for Collective Motion Bistability.” <em>Discrete &amp; Continuous Dynamical Systems - B</em> 24 (1531-3492): 851.</p>
</div>
<div>
<p>Goddard, Benjamin, Andreas Nold, and Serafim Kalliadasis. 2017. “2DChebClass.” <a href="https://doi.org/https://doi.org/10.7488/ds/1991.">https://doi.org/https://doi.org/10.7488/ds/1991.</a></p>
</div>
<div>
<p>Hegselmann, Rainer, and Ulrich Krause. 2002. “Opinion Dynamics and Bounded Confidence: Models, Analysis and Simulation.” <em>Journal of Artificial Societies and Social Simulation</em> 5: 1–24.</p>
</div>
<div>
<p>Lam, Siu Kwan, Antoine Pitrou, and Stanley Seibert. 2015. “Numba: A Llvm-Based Python Jit Compiler.” In <em>Proceedings of the Second Workshop on the Llvm Compiler Infrastructure in Hpc</em>. LLVM ’15. New York, NY, USA: Association for Computing Machinery. <a href="https://doi.org/10.1145/2833157.2833162">https://doi.org/10.1145/2833157.2833162</a>.</p>
</div>
<div>
<p>Mattingly, J., and A. M. Stuart. 2002. “Geometric Ergodicity of Some Hypo-Elliptic Diffusions for Particle Motions.” <em>Markov Processes and Related Fields</em> 8: 199–214.</p>
</div>
<div>
<p>Nagapetyan, Tigran, Andrew B. Duncan, Leonard Hasenclever, Sebastian J. Vollmer, Lukasz Szpruch, and Konstantinos Zygalakis. 2017. “The True Cost of Stochastic Gradient Langevin Dynamics.” <a href="http://arxiv.org/abs/1706.02692">http://arxiv.org/abs/1706.02692</a>.</p>
</div>
<div>
<p>Nold, Andreas, Benjamin D. Goddard, Peter Yatsyshin, Nikos Savva, and Serafim Kalliadasis. 2017. “Pseudospectral Methods for Density Functional Theory in Bounded and Unbounded Domains.” <em>Journal of Computational Physics</em> 334 (April): 639–64. <a href="https://doi.org/10.1016/j.jcp.2016.12.023">https://doi.org/10.1016/j.jcp.2016.12.023</a>.</p>
</div>
<div>
<p>Schelling, Thomas C. 1971. “Dynamic Models of Segregation.” <em>The Journal of Mathematical Sociology</em> 1 (2): 143–86. <a href="https://doi.org/10.1080/0022250X.1971.9989794">https://doi.org/10.1080/0022250X.1971.9989794</a>.</p>
</div>
<div>
<p>Sumpter, David J. T. 2010. <em>Collective Animal Behavior</em>. Princeton University Press. <a href="http://www.jstor.org/stable/j.ctt7tc00">http://www.jstor.org/stable/j.ctt7tc00</a>.</p>
</div>
<div>
<p>Vicsek, Tamás, András Czirók, Eshel Ben-Jacob, Inon Cohen, and Ofer Shochet. 1995. “Novel Type of Phase Transition in a System of Self-Driven Particles.” <em>Phys. Rev. Lett.</em> 75 (6): 1226–9. <a href="https://doi.org/10.1103/PhysRevLett.75.1226">https://doi.org/10.1103/PhysRevLett.75.1226</a>.</p>
</div>
<div>
<p>Xie, Yihui. 2016. <em>Bookdown: Authoring Books and Technical Documents with R Markdown</em>. Boca Raton, Florida: Chapman; Hall/CRC. <a href="https://github.com/rstudio/bookdown">https://github.com/rstudio/bookdown</a>.</p>
</div>
</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Numba">
<p>Lam, Siu Kwan, Antoine Pitrou, and Stanley Seibert. 2015. “Numba: A Llvm-Based Python Jit Compiler.” In <em>Proceedings of the Second Workshop on the Llvm Compiler Infrastructure in Hpc</em>. LLVM ’15. New York, NY, USA: Association for Computing Machinery. <a href="https://doi.org/10.1145/2833157.2833162">https://doi.org/10.1145/2833157.2833162</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="app-ergavg.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
