<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Numerical Studies | A Numerical Study of an Interacting Particle System</title>
  <meta name="description" content="5 Numerical Studies | A Numerical Study of an Interacting Particle System" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Numerical Studies | A Numerical Study of an Interacting Particle System" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Numerical Studies | A Numerical Study of an Interacting Particle System" />
  
  
  

<meta name="author" content="Thomas M. Hodgson" />


<meta name="date" content="2020-05-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="analysis.html"/>
<link rel="next" href="implementation.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Test</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="literature-review.html"><a href="literature-review.html"><i class="fa fa-check"></i><b>3</b> Literature Review</a><ul>
<li class="chapter" data-level="3.1" data-path="literature-review.html"><a href="literature-review.html#butta"><i class="fa fa-check"></i><b>3.1</b> Butta</a></li>
<li class="chapter" data-level="3.2" data-path="literature-review.html"><a href="literature-review.html#garnier"><i class="fa fa-check"></i><b>3.2</b> Garnier</a></li>
<li class="chapter" data-level="3.3" data-path="literature-review.html"><a href="literature-review.html#other-papers"><i class="fa fa-check"></i><b>3.3</b> Other Papers?</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="analysis.html"><a href="analysis.html"><i class="fa fa-check"></i><b>4</b> Analysis</a></li>
<li class="chapter" data-level="5" data-path="numerical-studies.html"><a href="numerical-studies.html"><i class="fa fa-check"></i><b>5</b> Numerical Studies</a><ul>
<li class="chapter" data-level="5.1" data-path="numerical-studies.html"><a href="numerical-studies.html#pde-simulation"><i class="fa fa-check"></i><b>5.1</b> PDE Simulation</a></li>
<li class="chapter" data-level="5.2" data-path="numerical-studies.html"><a href="numerical-studies.html#particle-system-simulation"><i class="fa fa-check"></i><b>5.2</b> Particle System Simulation</a><ul>
<li class="chapter" data-level="5.2.1" data-path="numerical-studies.html"><a href="numerical-studies.html#deterministic-model"><i class="fa fa-check"></i><b>5.2.1</b> Deterministic Model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="implementation.html"><a href="implementation.html"><i class="fa fa-check"></i><b>6</b> Implementation</a><ul>
<li class="chapter" data-level="6.1" data-path="implementation.html"><a href="implementation.html#v0.1"><i class="fa fa-check"></i><b>6.1</b> v0.1</a></li>
<li class="chapter" data-level="6.2" data-path="implementation.html"><a href="implementation.html#v0.2"><i class="fa fa-check"></i><b>6.2</b> v0.2</a></li>
<li class="chapter" data-level="6.3" data-path="implementation.html"><a href="implementation.html#v0.3"><i class="fa fa-check"></i><b>6.3</b> v0.3</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Numerical Study of an Interacting Particle System</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="numerical-studies" class="section level1">
<h1><span class="header-section-number">5</span> Numerical Studies</h1>
<p>What are we trying to do here? Learn more about Butta model, isolate what does what.</p>
<div id="pde-simulation" class="section level2">
<h2><span class="header-section-number">5.1</span> PDE Simulation</h2>
<p>Hundsdorfer-Verwer,
Extended to two dimensions, started on finite volume, flux limiting. Was slow, moved to DDFT software from BG. Ongoing work to simulate deterministic PDE</p>
</div>
<div id="particle-system-simulation" class="section level2">
<h2><span class="header-section-number">5.2</span> Particle System Simulation</h2>
<p>Results – Initial simulations show as expect
Low particle numbers
Hitting times
Moved to deterministic model:</p>
<ul>
<li>Effect of interation function hard cutoff</li>
<li>Effect of herding function/gradient</li>
</ul>
<div id="deterministic-model" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Deterministic Model</h3>
<p>In this section we will simplify the models by removing the noise term in the velocity equation. Through a series of examples we will show that despite the similarity, these models can behave very differently. This section will also show that although the PDE is the limit of the particle system, knowledge gained in the study of the PDE can not always be transferred. It will also serve as a good insight into the dynamics of the model. We first summarise the relevant PDE results presented in Butt`a et al. <span class="citation">[<a href="#ref-Butta2019" role="doc-biblioref">1</a>]</span>.</p>
<div id="product-distribution-is-a-solution" class="section level4">
<h4><span class="header-section-number">5.2.1.1</span> Product Distribution is a Solution</h4>
<p>Consider the stationary problem,
<span class="math display">\[\begin{equation}\label{eq:statPDE}
    - v\partial_x f_t(x,v) + \partial_v v f_t(x,v)- \partial_v \left[ G\left(M(t,x)\right)f_t(x,v))\right] + \sigma \partial_{vv} f_t(x,v) = 0.
\end{equation}\]</span></p>
<p>Here we will show that a product distribution is a solution of the stationary problem  if and only if it is uniform in the space variable and Gaussian in the velocity variable. Moreover, the Gaussian velocity can only have variance <span class="math inline">\(\sigma\)</span> and mean <span class="math inline">\(u\)</span> where <span class="math inline">\(u\)</span> solves <span class="math inline">\(G(u)=u\)</span>. Let <span class="math inline">\(f(x,v) = g(x)h(v)\)</span>, for some functions <span class="math inline">\(g,h\)</span>. Note the lack of dependence on <span class="math inline">\(t\)</span> as we seek stationary solutions. Then,</p>
<p><span class="math display">\[\begin{align*} 
    \partial_x g(x)h(v) &amp;= h(v)\partial_xg(x)\\
    \partial_v g(x)h(v) &amp;= g(x)\partial_v h(v)\\
    \partial_{vv} g(x)h(v) &amp;= g(x)\partial_{vv}h(v)
\end{align*}\]</span></p>
<p>The averaging function <span class="math inline">\(M(t,x)\)</span> can also be simplified.
<span class="math display">\[
\begin{aligned}[t]
    M(x) &amp;= \frac{\int_\mathbb{T}\mathrm{d} y\int_\mathbb{R}\mathrm{d} w  \,g(y)h(w)\varphi(x-y) w}{\int_\mathbb{T}\mathrm{d} y\int_{\mathbb{R}} \mathrm{d}  w  \,g(y)h(w)\varphi(x-y)}\\ 
    &amp;= \frac{\left( \int_\mathbb{R}\mathrm{d} w  \,w h(w)\right) \int_\mathbb{T}\mathrm{d}  y\,g(y)\varphi(x-y)}{\left( \int_{\mathbb{R}}\mathrm{d}  w  \,h(w)\right) \int_{\mathbb{T}}\mathrm{d} y\,g(y)\varphi(x-y)} &amp;&amp; \text{by independence}\\
    &amp;=  \int_{\mathbb{R}} \mathrm{d} w  \,w h(w) &amp;&amp; \text{}\\
    &amp;= \langle w\rangle_{h}
\end{aligned}
\]</span></p>
<p>Note here that the average velocity depends on the distribution. Substituting this all in to  gives,</p>
<p><span class="math display">\[\begin{equation}
    - vh(v)\partial_x g(x) + g(x)\partial_v\left[(v-G(\langle w\rangle))h(v) + \sigma \partial_v h(v)\right] = 0. 
\label{eq:statPDEproduct}  
\end{equation}\]</span></p>
<p>Then, integrating in space,
<span class="math display">\[\begin{align*}
&amp;\partial_v\left[(v-G(\langle w\rangle))h(v) + \sigma \partial_v h(v)\right] = 0\\
    \implies &amp; \left[(v-G(\langle w\rangle))h(v) + \sigma \partial_v h(v)\right] = \mathrm{const.}
\end{align*}\]</span>
where the first addend is zero by periodicity of the torus.
So,
<span class="math display">\[
    \partial_v h - \left(\frac{G(\langle w \rangle)-v}{\sigma}\right)h + \mathrm{const.} = 0.
\]</span>
This can be solved using an integrating factor to give
<span class="math display">\[
    h(v) = C\mathrm{e}^{\frac{2G(\langle w \rangle)v-v^2}{2\sigma}}.
\]</span>
Applying the normalising constraint gives
<span class="math display">\[  h(v) = \frac{1}{\sqrt{2\pi\sigma}}\mathrm{e}^{\frac{-(v-G(\langle w \rangle))^2}{2\sigma}}. \]</span></p>
<p>So the velocity distribution at stationarity is Gaussian with mean <span class="math inline">\(G(\langle w \rangle )\)</span> and variance <span class="math inline">\(\sigma^2\)</span>. If we take the smooth herding function <span class="math inline">\(G(u) = \frac{\mathrm{atanh}(u)}{\mathrm{atanh}(1)}\)</span>, this corresponds to a Gaussian with mean <span class="math inline">\(-1,0\)</span> or <span class="math inline">\(+1\)</span>, depending on the initial data. Returning to Equation , we see that the first addend must be identically zero for the equation to hold. In particular, this implies <span class="math inline">\(\partial_{x} g(x) = 0\)</span>, due to the positivity of <span class="math inline">\(h(v)\)</span> (as it is a Gaussian). We thus deduce that <span class="math inline">\(g\)</span> must be the uniform measure on <span class="math inline">\(\mathbb{T}\)</span>. Hence, $ f_{t}(x,v) = g_{t} (x)h_{t}(v)$ is a stationary solution of the PDE .</p>
</div>
<div id="convergence-depends-on-initial-average-velocity" class="section level4">
<h4><span class="header-section-number">5.2.1.2</span> Convergence Depends on Initial Average Velocity</h4>
<p>If we further assume space homogeneity of the PDE, that is, <span class="math inline">\(f_t(x,v) = h_t(v)\)</span>, we can infer exactly how the average velocity controls the dynamics. If we multiply the space homogeneous PDE by <span class="math inline">\(v\)</span> and integrate with respect to velocity we obtain
<span class="math display">\[ 
    \int v \partial_t h_t(v)\mathrm{d}  v = -\int v \partial_v G(\langle w \rangle ) h_t(v)\mathrm{d}  v + \int v \partial_v vh_t(v)\mathrm{d}  v + \sigma \int v \partial_vv h_t(v)\mathrm{d}  v 
\]</span>
Integrating by parts then gives an autonomous first order ODE.
<span class="math display">\[
    \partial_t \langle w \rangle = G(\langle w \rangle) - \langle w \rangle
\]</span>
As it is autonomous, the solution must be monotone, that is, the average velocity. There are stationary points whenever the average velocity solves <span class="math inline">\(G(\langle w \rangle ) =\langle w \rangle\)</span>, as expected from the product solution found previously. For example, if we take <span class="math inline">\(G(u) = \frac{\mathrm{atanh}(u)}{\mathrm{atanh}(1)}\)</span>, then the average velocity converges to $ -1, 0 $ or <span class="math inline">\(+1\)</span>, depending on the sign of the initial average velocity. If <span class="math inline">\(\langle w \rangle|_{t=0} &gt; 0\)</span>, then <span class="math inline">\(\langle w \rangle \to +1\)</span>. Similarly, the stationary point at <span class="math inline">\(-1\)</span> is stable and the system will converge there for any configuration such that <span class="math inline">\(\langle w \rangle|_{t=0} &lt; 0\)</span>. Finally, <span class="math inline">\(0\)</span> is an unstable equilibrium, only attainable when <span class="math inline">\(\langle w \rangle|_{t=0} = 0\)</span>. See Figure  for a phase plane diagram of the system when <span class="math inline">\(G\)</span> is the inverse hyperbolic tangent.</p>

<p>To summarise, there are three key facts gleaned here that we use to predict the behaviour of the particle system.</p>

Proceeding with the deterministic examples, we begin with the simplest case: a lone particle given a deterministic initial velocity.

<p>This is the simplest initial configuration, simply simulating one particle with a deterministic initial velocity:
<span class="math display">\[
x^{1,1}_0  = 0, \qquad v^{1,1}_0 = 2
\]</span>
The choices here are completely arbitrary, the dynamics will be the same regardless of position on the torus or the velocity. Figure  shows that the particle very quickly comes to a stop. This is intuitive from looking at the particle model, but obviously not predicted by the kinetic model. The particle model contains a damping term, while the only forcing arises through the interaction, in the absence of noise. This is because of the <span class="math inline">\(j\neq i\)</span> in the summation within the interaction term.
<span class="math display">\[
\frac{\sum_{j=1,  \,j\neq i }^N v^{j,N}_t\varphi(x^{j,N}_t - x^{i,N}_t)}{\sum_{j=1,  \,j\neq i }^N \varphi(x^{j,N}_t - x^{i,N}_t)}
\]</span>
In fact, this equation doesn’t make sense for only one particle as it evaluates to <span class="math inline">\(\frac{0}{0}\)</span>. We mitigate this numerically by adding a very small constant to the denominator, so that the term can be evaluated.</p>

<p>This example, while trivial, already illustrates the difference that can arise between kinetic and particle models. (Although, an interacting particle system with only one particle and no interaction is a  degenerate case.)</p>

With three particles in the system, more possible behaviours arise. We configure these particles as follows.
<span class="math display">\[
x^{1,3}_0 =0  \quad x^{2,3}_0 =\frac{6\pi}{100} \quad x^{3,3}_0 = \frac{4\pi}{3}\\
v^{1,3}_0 =1.5  \quad v^{2,3}_0 =1 \quad v^{3,3}_0 = 0
\]</span>
If we use the indicator interaction function,
<span class="math display">\[\begin{equation}\label{eq:indicatorinteraction}
\varphi(x) = \mathbbm{1}_{[0,\gamma L]}(\|x\|), \quad 0 \leq \gamma \leq \frac{1}{2},
\end{equation}\]</span>
the interaction radius <span class="math inline">\(\gamma\)</span> determines the convergence of this setup. Here, the system has positive initial average velocity, and as such we expect a monotone convergence to <span class="math inline">\(+1\)</span>. Indeed, taking the interaction radius large enough, for example <span class="math inline">\(\gamma = 0.06\)</span>, this is exactly what happens. The system coalesces into one cluster travelling at velocity <span class="math inline">\(+1\)</span>. Note here that in the absence of noise we expect neither a normally distributed velocity or a uniform distribution in space. However, if we instead take <span class="math inline">\(\gamma = 0.04\)</span>, the interaction is not strong enough for the particles to coalesce. One particle is always left behind as the two clustered particles pass by. This causes a periodic average velocity—that is, not monotone, immediately in contrast to  above. It is to be expected that an equation derived from the limit as the number of particles tends to infinity does not reflect the behaviour of just three particles.
<p style="color:red">
The problem here is not just that you don’t have enough particles (as we have seen, we can obtain periodic behaviour with arbitrarily large number of particles) but also the fact tat we don’t know (because we haven’t studied it) the behaviour of the limiting equation that you would obtain by sending N to infinity without noise – M
</p>
<p>Finally, if the interaction radius is too small, say <span class="math inline">\(\gamma = 0.01\)</span>, then the system behaves as the one particle case, with all particles becoming stationary. This is because the fast moving particle passes through the slower particle without having sufficient time to coalesce. Relevant animations for these three behaviours are </p>

<p>Next, we arrange the particles so that the distance between them increases linearly. That is the distance between the first two is 1, between second and third is 2, etc. The gaps are then scaled onto the torus. This will allow the control of how many particles initially interact.</p>
<p>Here it seems that there are two possibilities: either the system converges to positive average velocity 1 or a periodic orbit occurs, depending on <span class="math inline">\(\gamma\)</span>. However, the regime in which <span class="math inline">\(\gamma\)</span> causes a periodic trajectory also depends on <span class="math inline">\(N\)</span>. For larger <span class="math inline">\(N\)</span>, <span class="math inline">\(\gamma\)</span> has to become exceedingly small to produce any interesting behaviour. This is because the gap between the first few particles becomes very small.</p>


<p>The most illustrative example is starting the particles in two diametrically opposite clusters of equal width one containing one third of the total particles with positive velocity, and the other containing two thirds of the particles with negative velocity. This allows for an interesting setup—most particles can move with negative velocity while the average velocity remains positive. We give each particle in the small cluster velocity <span class="math inline">\(1.8\)</span>, while in the larger cluster all particles have velocity <span class="math inline">\(-0.2\)</span>. The initial average velocity of the system is thus around <span class="math inline">\(+\frac{1}{2}\)</span>. The values were chosen so that each cluster is an equal distance from its equilibrium value, were it the only cluster in the system.</p>
<p><span class="math display">\[\begin{align*}
x^{i,3N}_0 &amp;\sim U\left[\pi-\frac{\pi}{10},\pi+\frac{\pi}{10}\right],  
&amp;&amp;v^{i,3N} = -0.2 
\quad \text{ for } 1\leq i\leq 2N,\\
x^{i,3N}_0 &amp;\sim U\left[-\frac{\pi}{10},\frac{\pi}{10}\right],  &amp;&amp;v^{i,3N} = 1.8\quad \text{ for } 2N\leq i\leq 3N.
\end{align*}\]</span></p>
<p>This is the first example that exhibits a clear difference depending on the scaling used in the interaction term. We will use the term <em>local scaling</em> to describe the model of <span class="citation">[<a href="#ref-Butta2019" role="doc-biblioref">1</a>]</span> with interaction term,
<span class="math display">\[ M(t,x) = \frac{\sum_{j=1, j != i}^N v^{j,N}_t \varphi(x^{j,N}_t  - x^{i,N}_t)}{\sum_{j=1, j != i}^N \varphi(x^{j,N}_t  - x^{i,N}_t)},\]</span>
that is where the interaction is modulated by the number of particles with which each particle is interacting. In contrast, the term <em>global scaling</em> describes the model of <span class="citation">[<a href="#ref-Garnier2019" role="doc-biblioref">2</a>]</span> with interaction term,
<span class="math display">\[M(t,x) = \frac{\sum_{j=1, j \neq i}^N v^{j,N}_t \varphi(x^{j,N}_t  - x^{i,N}_t)}{N},\]</span>
where we scale by the total number of particles in the system, irrespective of interaction. Note that if we use the indicator interaction function, , the local scaling converges to the global scaling as the interaction radius increases, i.e. <span class="math display">\[\sum_{j=1, j \neq i}^N \varphi(x^{j,N}_t  - x^{i,N}_t) \to N \text{ as } \gamma \to \frac{1}{2}. \]</span></p>

<p>Figure  shows the average velocity of a wide range of interaction radii and particle numbers. There a few things to note here. First, the interaction radius has complete control over the convergence. This is in contrast to , the average velocity is not determining the convergence value. Second, the number of particles in the system has no effect on whether the system converges to <span class="math inline">\(+1\)</span> or <span class="math inline">\(-1\)</span> and a negligible effect on the speed of convergence. Thirdly, the average velocity is not monotone, even for large numbers of particles—in contrast to . This happens for all <span class="math inline">\(0.2 \leq\gamma\leq 0.45\)</span>. For <span class="math inline">\(\gamma = 0.05\)</span> we see that the system settles into a periodic orbit, before eventually converging to <span class="math inline">\(-1\)</span>.</p>

<p>This is the first example in which we see a stark difference between the locally-scaled and globally-scaled models. When the systems are evolved for only <span class="math inline">\(50s\)</span>, the systems appear to converge to a value dependent on the interaction radius. In fact, these are not stable points and evolving for <span class="math inline">\(500s\)</span> allows the systems to settle to <span class="math inline">\(\pm1\)</span>. See Figure . Periodic, erratic trajectories are also much more prevalent in this model. We also see that some systems do not converge within <span class="math inline">\(500s\)</span>, instead remaining in a periodic trajectory. The average velocity time series is not very illuminating here—in the corresponding animations it can be seen that these are the result of one large cluster forming and few particles remaining separate. The cluster is not strong enough to retain these particles as it passes by. The lone particle is then left behind by the cluster where it slows until the next orbit of the large cluster. This is state remains even for <span class="math inline">\(1000s\)</span>, see for example . Irrespective of scaling, once the radius of interaction and the initial data are fixed, both models converge eventually to the same average velocity. We have not observed any regimes in which the globally scaled equation converges to <span class="math inline">\(+1\)</span> while the locally scaled model converges to <span class="math inline">\(-1\)</span> (or vice versa).</p>

<p><img src="DetImages/2NNCluster/tau_local_quick.png" /></p>
<div class="figure"><span id="fig:fig2NNtau"></span>
<img src="DetImages/2NNCluster/tau_global_long_no_outlier.png" alt="Time taken to converge for the local  subfig:2NNtaulocal and global subfig:2NNtauglobal scaling. In subfig:2NNtauglobal, values that did not converge within 500s have been represented as grey squares. We see the dependence on interaction radius for larger gamma  and the independence of  N in both cases. The chequerboard effect at intermediate values is caused by the randomness inherent in the initial spatial configuration. Note the difference in scale between the two subfigures." width="50%" /><img src="DetImages/2NNCluster/tau_local_quick.png" alt="Time taken to converge for the local  subfig:2NNtaulocal and global subfig:2NNtauglobal scaling. In subfig:2NNtauglobal, values that did not converge within 500s have been represented as grey squares. We see the dependence on interaction radius for larger gamma  and the independence of  N in both cases. The chequerboard effect at intermediate values is caused by the randomness inherent in the initial spatial configuration. Note the difference in scale between the two subfigures." width="50%" />
<p class="caption">
Figure 5.1: Time taken to converge for the local subfig:2NNtaulocal and global subfig:2NNtauglobal scaling. In subfig:2NNtauglobal, values that did not converge within 500s have been represented as grey squares. We see the dependence on interaction radius for larger gamma and the independence of N in both cases. The chequerboard effect at intermediate values is caused by the randomness inherent in the initial spatial configuration. Note the difference in scale between the two subfigures.
</p>
</div>
<p>So we see that the space homogeneous PDE and the particle system have very different behaviours, including stable states. The next step is to assess whether the clusters persist in any way in the particle system—a phenomenon we don’t expect in the noisy system by +++P:product++. For this, we use the same initial condition.</p>
</div>
<div id="number-of-clusters" class="section level4">
<h4><span class="header-section-number">5.2.1.3</span> Number of Clusters</h4>
<p>The number of clusters was assessed using histograms of the particles’ positions at either <span class="math inline">\(50s\)</span> (in the locally scaled system) or <span class="math inline">\(500s\)</span> (in the globally scaled model). The longer time scale for the global case is so that the system has time to settle into a stable average velocity. Tables  and  summarise the result. In either case, a clustered pattern persists. This is intuitive in the deterministic model as there is no noise to break the clusters apart. Any dispersion can only arise through the interaction term, which will be approximately equal for two particles close together. For the local scaling, more clusters appear when <span class="math inline">\(\gamma\)</span> is lower. When scaling globally however, there is always only one cluster remaining. This is perhaps because in the locally scaled model, for each cluster, the interaction is comparable due to the normalising effect of the denominator. In the globally scaled model, smaller clusters are penalised more heavily their interaction being reduced by the constant scaling by <span class="math inline">\(N\)</span>. Smaller clusters thus get caught by larger clusters. This is not yet a contradiction of +++P:product+++, as we are only looking at the deterministic case, <span class="math inline">\(\sigma = 0\)</span>.</p>
<p>+++LOCAL CLUSTER TABLE+++Number of clusters remaining after <span class="math inline">\(50s\)</span> in the locally scaled system. Note that <span class="math inline">\(N\)</span> has very little effect on the clustering while the radius of interaction does.}
tab:localcluster</p>
<pre><code>+++GLOBAL CLUSTER TABLE+++ Number of clusters remaining after $500$ in the globally scaled system. In contrast to the local system, only one cluster persists in any regime.</code></pre>
</div>
<div id="introducing-random-velocity-distributions" class="section level4">
<h4><span class="header-section-number">5.2.1.4</span> Introducing Random Velocity Distributions</h4>
<p>Thus far, we have only considered deterministic initial velocities. Keeping the spatial initial condition the same, we instead assign initial velocities of particles in each cluster drawn from a normal distribution as follows
<span class="math display">\[\begin{align*} 
v^{i,3N} \sim \mathcal{N}(-0.2,0.5^2) \quad \text{ for } 1\leq i\leq 2N,\\
v^{i,3N}   \sim \mathcal{N}(1.8,0.5^2) \quad \text{ for } 
2N\leq i\leq 3N.
\end{align*}\]</span>
The variance of the distributions was chosen here so that it was very unlikely that the average velocity of the whole cluster deviated too far from its mean value, thus approximately preserving the distance from equilibria discussed earlier. Figure  shows the average velocities analogous to Figure  for this setup. For larger <span class="math inline">\(\gamma\)</span>, the normally distributed does not affect the convergence compared to the deterministic initial velocity. In the local scaling, this indifference persists to lower <span class="math inline">\(\gamma\)</span>. The only difference is for some intermediate radii, <span class="math inline">\(\gamma \approx 0.2\)</span>, the system converges to <span class="math inline">\(+1\)</span> as opposed to <span class="math inline">\(-1\)</span>. This however is only one realisation of the initial data. In the globally scaled case, the random velocity has more of an effect. Here it affects the convergence of both larger and smaller <span class="math inline">\(\gamma\)</span>, with many systems oscillating close to <span class="math inline">\(\pm 1\)</span>.</p>
<p><img src="DetImages/2NNCluster/avg_vel_small_noise_local_long.png" />
label:subfig:avg_vel_small_noise_local
<img src="DetImages/2NNCluster/avg_vel_small_noise_global_long.png" />
label: subfig:avg_vel_small_noise_global
caption: When the initial velocities are instead normally distributed instead of constant, we see different behaviour (c.f. Figure ,). There is still a change in behaviour around <span class="math inline">\(\gamma\approx 0.2\)</span> however it is much less well defined. The setup here is identical to Figure , other than the initial velocity distribution. We also see that some setups that previously converged to <span class="math inline">\(-1\)</span> converge to <span class="math inline">\(+1\)</span>. Note that this is only one realisation of the initial configuration, upon averaging over many runs it should be similar to the deterministic initial condition.
label :fig:avg_vel_small_noise</p>
<p>Simplifying to the deterministic models illuminates the effects of different terms, without the effect of noise. We have seen here that the particle system average velocity is not monotone, and that it does not govern the equilibrium value. This has also made clear the difference in the two models, despite their similarity. In particular, the global scaling slows convergence for many different interaction radii compared to an identical locally scaled system.</p>

</div>
</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Butta2019">
<p>[1] <span class="smallcaps">Buttà</span>, P., <span class="smallcaps">Flandoli</span>, F., <span class="smallcaps">Ottobre</span>, M. and <span class="smallcaps">Zegarlinski</span>, B. (2019). A non-linear kinetic model of self-propelled particles with multiple equilibria. <em>Kinetic &amp; Related Models</em> <strong>12(4)</strong> 791–827.</p>
</div>
<div id="ref-Garnier2019">
<p>[2] <span class="smallcaps">Garnier</span>, J., <span class="smallcaps">Papanicolaou</span>, G. and <span class="smallcaps">Yang</span>, T.-W. (2019). Mean field model for collective motion bistability. <em>Discrete &amp; Continuous Dynamical Systems - B</em> <strong>24</strong> 851.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="implementation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
