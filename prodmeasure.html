<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Product Measure | A Numerical Study of an Interacting Particle System</title>
  <meta name="description" content="5 Product Measure | A Numerical Study of an Interacting Particle System" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Product Measure | A Numerical Study of an Interacting Particle System" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Product Measure | A Numerical Study of an Interacting Particle System" />
  
  
  

<meta name="author" content="Tom271" />


<meta name="date" content="2020-05-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="future.html"/>
<link rel="next" href="appPSmeanZero.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />












</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="litreview.html"><a href="litreview.html"><i class="fa fa-check"></i><b>2</b> The Model</a></li>
<li class="chapter" data-level="3" data-path="num-studies.html"><a href="num-studies.html"><i class="fa fa-check"></i><b>3</b> Numerical Studies</a></li>
<li class="chapter" data-level="4" data-path="future.html"><a href="future.html"><i class="fa fa-check"></i><b>4</b> Future Work</a></li>
<li class="chapter" data-level="5" data-path="prodmeasure.html"><a href="prodmeasure.html"><i class="fa fa-check"></i><b>5</b> Product Measure</a><ul>
<li class="chapter" data-level="5.1" data-path="prodmeasure.html"><a href="prodmeasure.html#product-distribution-is-a-solution"><i class="fa fa-check"></i><b>5.1</b> Product Distribution is a Solution</a></li>
<li class="chapter" data-level="5.2" data-path="prodmeasure.html"><a href="prodmeasure.html#convergence-depends-on-initial-average-velocity"><i class="fa fa-check"></i><b>5.2</b> Convergence Depends on Initial Average Velocity</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="appPSmeanZero.html"><a href="appPSmeanZero.html"><i class="fa fa-check"></i><b>6</b> Particle System has Mean Zero</a></li>
<li class="chapter" data-level="7" data-path="appergavg.html"><a href="appergavg.html"><i class="fa fa-check"></i><b>7</b> Ergodic Averages</a></li>
<li class="chapter" data-level="8" data-path="appimplementation.html"><a href="appimplementation.html"><i class="fa fa-check"></i><b>8</b> Implementation</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Numerical Study of an Interacting Particle System</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="prodmeasure" class="section level1">
<h1><span class="header-section-number">5</span> Product Measure</h1>
<div id="product-distribution-is-a-solution" class="section level2">
<h2><span class="header-section-number">5.1</span> Product Distribution is a Solution</h2>
<p>Consider the stationary problem,
<span class="math display">\[\begin{equation}\label{eq:statPDE}
    - v\partial_x f_t(x,v) + \partial_v v f_t(x,v)- \partial_v \left[ G\left(M(t,x)\right)f_t(x,v))\right] + \sigma \partial_{vv} f_t(x,v) = 0.
\end{equation}\]</span></p>
<p>Here we will show that a product distribution is a solution of the stationary problem  if and only if it is uniform in the space variable and Gaussian in the velocity variable. Moreover, the Gaussian velocity can only have variance <span class="math inline">\(\sigma\)</span> and mean <span class="math inline">\(u\)</span> where <span class="math inline">\(u\)</span> solves <span class="math inline">\(G(u)=u\)</span>. Let <span class="math inline">\(f(x,v) = g(x)h(v)\)</span>, for some functions <span class="math inline">\(g,h\)</span>. Note the lack of dependence on <span class="math inline">\(t\)</span> as we seek stationary solutions. Then,</p>
<p><span class="math display">\[\begin{align*} 
    \partial_x g(x)h(v) &amp;= h(v)\partial_xg(x)\\
    \partial_v g(x)h(v) &amp;= g(x)\partial_v h(v)\\
    \partial_{vv} g(x)h(v) &amp;= g(x)\partial_{vv}h(v)
\end{align*}\]</span></p>
<p>The averaging function <span class="math inline">\(M(t,x)\)</span> can also be simplified.
<span class="math display">\[
\begin{aligned}[t]
    M(x) &amp;= \frac{\int_\mathbb{T}\mathrm{d} y\int_\mathbb{R}\mathrm{d} w  \,g(y)h(w)\varphi(x-y) w}{\int_\mathbb{T}\mathrm{d} y\int_{\mathbb{R}} \mathrm{d}  w  \,g(y)h(w)\varphi(x-y)}\\ 
    &amp;= \frac{\left( \int_\mathbb{R}\mathrm{d} w  \,w h(w)\right) \int_\mathbb{T}\mathrm{d}  y\,g(y)\varphi(x-y)}{\left( \int_{\mathbb{R}}\mathrm{d}  w  \,h(w)\right) \int_{\mathbb{T}}\mathrm{d} y\,g(y)\varphi(x-y)} &amp;&amp; \text{by independence}\\
    &amp;=  \int_{\mathbb{R}} \mathrm{d} w  \,w h(w) &amp;&amp; \text{}\\
    &amp;= \bar{v}
\end{aligned}
\]</span></p>
<p>Note here that the average velocity depends on the distribution. Substituting this all in to  gives,
<span class="math display">\[\begin{equation}
    - vh(v)\partial_x g(x) + g(x)\partial_v\left[(v-G(\bar{v}))h(v) + \sigma \partial_v h(v)\right] = 0. 
\label{eq:statPDEproduct}  
\end{equation}\]</span>
Then, integrating in space,
<span class="math display">\[\begin{align*}
&amp;\partial_v\left[(v-G(\bar{v}))h(v) + \sigma \partial_v h(v)\right] = 0\\
    \implies &amp; \left[(v-G(\bar{v}))h(v) + \sigma \partial_v h(v)\right] = \mathrm{const.}
\end{align*}\]</span>
where the first addend is zero by periodicity of the torus.
So,
<span class="math display">\[
    \partial_v h - \left(\frac{G(\bar{v})-v}{\sigma}\right)h + \mathrm{const.} = 0.
\]</span>
This can be solved using an integrating factor to give
<span class="math display">\[
    h(v) = C\mathrm{e}^{\frac{2G(\bar{v})v-v^2}{2\sigma}}.
\]</span>
Applying the normalising constraint gives
<span class="math display">\[  h(v) = \frac{1}{\sqrt{2\pi\sigma}}\mathrm{e}^{\frac{-(v-G(\bar{v}))^2}{2\sigma}}.
 \]</span>
If we now multiply by <span class="math inline">\(v\)</span> and integrate with respect to velocity we obtain
<span class="math display">\[
\bar{v} = \int v h(v)\mathrm{d}v = \int v \frac{1}{\sqrt{2\pi\sigma}}\mathrm{e}^{\frac{-(v-G(\bar{v}))^2}{2\sigma}}\mathrm{d}v = G(\bar{v}).
\]</span></p>
<p>So the velocity distribution at stationarity is Gaussian with mean <span class="math inline">\(G(\langle w \rangle )\)</span> and variance <span class="math inline">\(\sigma^2\)</span>. If we take the smooth herding function <span class="math inline">\(G(u) = \frac{\mathrm{atanh}(u)}{\mathrm{atanh}(1)}\)</span>, this corresponds to a Gaussian with mean <span class="math inline">\(-1,0\)</span> or <span class="math inline">\(+1\)</span>. Returning to Equation , we see that the first addend must be identically zero for the equation to hold. In particular, this implies <span class="math inline">\(\partial_{x} g(x) = 0\)</span>, due to the positivity of <span class="math inline">\(h(v)\)</span> (as it is a Gaussian). We thus deduce that <span class="math inline">\(g\)</span> must be the uniform measure on <span class="math inline">\(\mathbb{T}\)</span>. Hence, <span class="math inline">\(f(x,v)=g(x)h(v)\)</span> is a stationary solution of the PDE .</p>
</div>
<div id="convergence-depends-on-initial-average-velocity" class="section level2">
<h2><span class="header-section-number">5.2</span> Convergence Depends on Initial Average Velocity</h2>
<p>If we further assume space homogeneity of the PDE, that is, <span class="math inline">\(f_t(x,v) = h_t(v)\)</span>, we can infer exactly how the average velocity controls the dynamics. If we multiply the space homogeneous PDE by <span class="math inline">\(v\)</span> and integrate with respect to velocity we obtain
<span class="math display">\[ 
    \int v \partial_t h_t(v)\mathrm{d}  v = -\int v \partial_v G(M(t)) h_t(v)\mathrm{d}  v + \int v \partial_v vh_t(v)\mathrm{d}  v + \sigma \int v \partial_vv h_t(v)\mathrm{d}  v 
\]</span>
Integrating by parts then gives an autonomous first order ODE.
<span class="math display">\[
    \partial_t M(t)  = G(M(t) ) - M(t)
\]</span>
As this equation is autonomous, the average velocity must be monotone. There are stationary points whenever the average velocity solves $G(M(t)) =M(t) $, as expected from the product solution found previously. For example, if we take <span class="math inline">\(G(u) = \frac{\mathrm{atanh}(u)}{\mathrm{atanh}(1)}\)</span>, then the average velocity converges to $ -1, 0 $ or <span class="math inline">\(+1\)</span>, depending on the sign of the initial average velocity. If <span class="math inline">\(M(0) &gt; 0\)</span>, then <span class="math inline">\(M(t) \to +1\)</span>. Similarly, the stationary point at <span class="math inline">\(-1\)</span> is stable and the system will converge there for any configuration such that <span class="math inline">\(M(0) &lt; 0\)</span>. Finally, <span class="math inline">\(0\)</span> is an unstable equilibrium, only attainable when <span class="math inline">\(M(0) = 0\)</span>. See Figure  for a phase plane diagram of the system when <span class="math inline">\(G\)</span> is the inverse hyperbolic tangent.</p>

<p>In a similar manner, we can also obtain equations for other moments. Denoting the <span class="math inline">\(n^{\text{th}}\)</span> moment at time <span class="math inline">\(t\)</span> by <span class="math inline">\(M_n(t)\)</span>, we obtain:
<span class="math display">\[\begin{align*}
   \dot{M}_0(t) &amp;= 0\\
   \dot{M}_1(t) &amp;= G(M_1(t))-M_1(t) &amp;&amp; \text{as above}\\
   \dot{M}_2(t) &amp;= 2\left[G(M_1)M_1-M_2+\sigma \right].
\end{align*}\]</span>
The first of these equations shows that the system conserves mass, an important property we must preserve when simulating numerically. The second is a restatement of the result above, and gives convergence of the average velocity. The final equation gives the convergence of the variance.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="future.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="appPSmeanZero.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
